<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Urban Alchemy ğŸ§ª</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(#dff5ea, #ffffff);
    text-align: center;
    padding: 20px;
  }

  h1 {
    margin-bottom: 8px;
  }

  button {
    padding: 10px 18px;
    border: none;
    border-radius: 8px;
    background: #4caf50;
    color: white;
    cursor: pointer;
    font-size: 14px;
  }

  /* HOME */
  #homeScreen {
    max-width: 500px;
    margin: 100px auto;
    background: white;
    padding: 30px;
    border-radius: 16px;
  }

  /* GAME */
  #gameScreen {
    display: none;
  }

  #topBar {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .scene {
    background: white;
    padding: 25px;
    border-radius: 16px;
    max-width: 650px;
    margin: 20px auto;
  }

  .item {
    background: #e3f2fd;
    border: 2px solid #64b5f6;
    padding: 14px;
    border-radius: 12px;
    width: 180px;
    margin: 0 auto 20px;
    cursor: grab;
    font-size: 16px;
  }

  .cauldrons {
    display: flex;
    justify-content: center;
    gap: 30px;
    margin-top: 20px;
  }

  .cauldron {
    background: #f3e5f5;
    border: 3px dashed #8e24aa;
    padding: 20px;
    border-radius: 50%;
    width: 180px;
    height: 180px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
  }

  /* Wizard Modal */
  .modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.45);
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    background: white;
    padding: 25px;
    border-radius: 14px;
    max-width: 420px;
    text-align: left;
  }
</style>
</head>

<body>

<!-- HOME SCREEN -->
<div id="homeScreen">
  <h1>ğŸ§ª Urban Alchemy</h1>
  <p>
    You are a magical urban alchemist cleaning up cities across Georgia.
    Sort waste into enchanted cauldrons to restore balance, earn sustainability
    power, and unlock new locations.
  </p>
  <button onclick="startGame()">Start Game</button>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen">
  <div id="topBar">
    <h2 id="levelTitle"></h2>
    <button onclick="resetGame()">ğŸ  Home</button>
  </div>

  <p id="score">âœ¨ Sustainability Power: 0</p>

  <div class="scene">
    <h3>ğŸ§º Current Item</h3>
    <div id="itemContainer"></div>

    <h3>ğŸ§ª Magical Cauldrons</h3>
    <div class="cauldrons">
      <div class="cauldron" data-choice="recycle">
        â™»ï¸ Recycling<br>Cauldron
      </div>
      <div class="cauldron" data-choice="compost">
        ğŸŒ± Composting<br>Cauldron
      </div>
    </div>
  </div>
</div>

<!-- WIZARD -->
<div class="modal" id="wizardModal">
  <div class="modal-content">
    <h3>ğŸ§™â€â™‚ï¸ Wizard of Sustainability</h3>
    <p id="wizardText"></p>
    <button onclick="closeWizard()">Continue</button>
  </div>
</div>

<script>
/* ---------- DATA ---------- */

const levels = [
  { name: "ğŸ“ Atlanta" },
  { name: "ğŸ“ Savannah" },
  { name: "ğŸ“ Athens" }
];

const items = [
  { name: "plastic bottle", emoji: "ğŸ¼", best: "recycle" },
  { name: "banana peel", emoji: "ğŸŒ", best: "compost" },
  { name: "cardboard box", emoji: "ğŸ“¦", best: "recycle" },
  { name: "old phone", emoji: "ğŸ“±", best: "recycle" }
];

let levelIndex = 0;
let score = 0;
let itemQueue = [];
let currentItem = null;

/* ---------- FLOW ---------- */

function startGame() {
  document.getElementById("homeScreen").style.display = "none";
  document.getElementById("gameScreen").style.display = "block";
  score = 0;
  levelIndex = 0;
  loadLevel();
}

function resetGame() {
  document.getElementById("gameScreen").style.display = "none";
  document.getElementById("homeScreen").style.display = "block";
}

function loadLevel() {
  document.getElementById("levelTitle").innerText = levels[levelIndex].name;
  document.getElementById("score").innerText =
    "âœ¨ Sustainability Power: " + score;

  itemQueue = shuffle([...items]);
  showNextItem();
}

function showNextItem() {
  const container = document.getElementById("itemContainer");
  container.innerHTML = "";

  if (itemQueue.length === 0) {
    levelIndex++;
    if (levelIndex < levels.length) {
      loadLevel();
    } else {
      alert("ğŸ‰ You have mastered Urban Alchemy!");
      resetGame();
    }
    return;
  }

  currentItem = itemQueue.shift();

  const div = document.createElement("div");
  div.className = "item";
  div.draggable = true;
  div.innerText = `${currentItem.emoji} ${currentItem.name}`;
  div.addEventListener("dragstart", () => draggedItem = currentItem);

  container.appendChild(div);
}

/* ---------- DRAG & DROP ---------- */

let draggedItem = null;

document.querySelectorAll(".cauldron").forEach(c => {
  c.addEventListener("dragover", e => e.preventDefault());
  c.addEventListener("drop", () => judgeMove(c.dataset.choice));
});

/* ---------- WIZARD ---------- */

function judgeMove(choice) {
  const correct = draggedItem.best === choice;
  score += correct ? 20 : 5;

  const message = correct
    ? `âœ¨ Excellent transmutation!\n\nYou placed the ${draggedItem.name} into the correct cauldron. This choice reflects real-world sustainability practices that reduce landfill waste and protect Georgiaâ€™s environment.\n\nYour magic strengthens the city.`
    : `âš ï¸ A learning spell!\n\nThat item could have been better transmuted elsewhere. Even so, mistakes help young alchemists grow wiser.\n\nThe wizard encourages you to try again thoughtfully.`;

  document.getElementById("wizardText").innerText = message;
  document.getElementById("wizardModal").style.display = "flex";
  document.getElementById("score").innerText =
    "âœ¨ Sustainability Power: " + score;
}

function closeWizard() {
  document.getElementById("wizardModal").style.display = "none";
  showNextItem();
}

/* ---------- UTILS ---------- */

function shuffle(arr) {
  return arr.sort(() => Math.random() - 0.5);
}
</script>

</body>
</html>
