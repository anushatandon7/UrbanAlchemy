<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Urban Alchemy ğŸ§ª</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(#e0f7fa, #ffffff);
    text-align: center;
    padding: 20px;
  }

  #topBar {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  button {
    padding: 10px 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    background: #4caf50;
    color: white;
    font-size: 14px;
  }

  .scene {
    background: white;
    padding: 20px;
    border-radius: 12px;
    max-width: 700px;
    margin: 20px auto;
  }

  .items, .cauldrons {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
    margin: 20px 0;
  }

  .item {
    background: #e3f2fd;
    border: 2px solid #64b5f6;
    padding: 12px;
    border-radius: 10px;
    cursor: grab;
    width: 150px;
  }

  .cauldron {
    background: #f3e5f5;
    border: 2px dashed #ab47bc;
    padding: 15px;
    border-radius: 12px;
    width: 170px;
  }

  /* Wizard Modal */
  .modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    background: white;
    padding: 25px;
    border-radius: 14px;
    max-width: 450px;
    text-align: left;
  }
</style>
</head>

<body>

<!-- HOME SCREEN -->
<div id="homeScreen">
  <h1>ğŸ§ª Urban Alchemy</h1>
  <p>You are a wizard restoring Georgia cities through sustainability magic.</p>
  <button onclick="startGame()">Start Game</button>
</div>

<!-- GAME SCREEN -->
<div id="gameScreen" style="display:none;">
  <div id="topBar">
    <h2 id="levelTitle"></h2>
    <button onclick="resetGame()">ğŸ  Home</button>
  </div>

  <p id="score">âœ¨ Sustainability Power: 0</p>

  <div class="scene">
    <h3>ğŸ§º Items to Sort</h3>
    <div class="items" id="itemsContainer"></div>

    <h3>ğŸ§ª Cauldrons</h3>
    <div class="cauldrons">
      <div class="cauldron" data-choice="recycle">â™»ï¸ Recycle</div>
      <div class="cauldron" data-choice="compost">ğŸŒ± Compost</div>
    </div>
  </div>
</div>

<!-- WIZARD POPUP -->
<div class="modal" id="wizardModal">
  <div class="modal-content">
    <h3>ğŸ§™â€â™‚ï¸ Wizard of Sustainability</h3>
    <p id="wizardText"></p>
    <button onclick="closeWizard()">Continue</button>
  </div>
</div>

<script>
/* ---------------- GAME DATA ---------------- */

const levels = [
  {
    name: "ğŸ“ Atlanta",
    items: ["plastic bottle", "banana peel", "cardboard box"]
  },
  {
    name: "ğŸ“ Savannah",
    items: ["plastic bottle", "banana peel", "old phone"]
  },
  {
    name: "ğŸ“ Athens",
    items: ["banana peel", "cardboard box", "plastic bottle"]
  }
];

const itemInfo = {
  "plastic bottle": { emoji: "ğŸ¼", best: "recycle" },
  "banana peel": { emoji: "ğŸŒ", best: "compost" },
  "cardboard box": { emoji: "ğŸ“¦", best: "recycle" },
  "old phone": { emoji: "ğŸ“±", best: "recycle" }
};

let currentLevel = 0;
let score = 0;
let remainingItems = [];

/* ---------------- GAME FLOW ---------------- */

function startGame() {
  document.getElementById("homeScreen").style.display = "none";
  document.getElementById("gameScreen").style.display = "block";
  score = 0;
  currentLevel = 0;
  loadLevel();
}

function resetGame() {
  document.getElementById("gameScreen").style.display = "none";
  document.getElementById("homeScreen").style.display = "block";
}

function loadLevel() {
  const level = levels[currentLevel];
  document.getElementById("levelTitle").innerText = level.name;
  document.getElementById("score").innerText =
    "âœ¨ Sustainability Power: " + score;

  remainingItems = shuffle([...level.items]);
  renderItems();
}

function renderItems() {
  const container = document.getElementById("itemsContainer");
  container.innerHTML = "";

  remainingItems.forEach(item => {
    const div = document.createElement("div");
    div.className = "item";
    div.draggable = true;
    div.dataset.item = item;
    div.innerText = `${itemInfo[item].emoji} ${item}`;
    div.addEventListener("dragstart", () => draggedItem = item);
    container.appendChild(div);
  });
}

/* ---------------- DRAG & DROP ---------------- */

let draggedItem = null;

document.querySelectorAll(".cauldron").forEach(cauldron => {
  cauldron.addEventListener("dragover", e => e.preventDefault());
  cauldron.addEventListener("drop", () => {
    const choice = cauldron.dataset.choice;
    judgeMove(draggedItem, choice);
  });
});

/* ---------------- AI WIZARD ---------------- */

function judgeMove(item, choice) {
  const correct = itemInfo[item].best === choice;
  let points = correct ? 20 : 5;

  score += points;
  remainingItems = remainingItems.filter(i => i !== item);

  let message =
    correct
    ? `âœ¨ Excellent transmutation!\n\nBy placing the ${item} into the ${choice} cauldron, you used sustainability magic correctly. This helps reduce waste, conserve resources, and protect Georgiaâ€™s ecosystems.\n\nYour wisdom grows stronger ğŸŒ`
    : `âš ï¸ A learning moment!\n\nThe ${item} would have been better suited for a different cauldron. Still, even imperfect magic teaches valuable lessons.\n\nTry again wisely next time!`;

  document.getElementById("wizardText").innerText = message;
  document.getElementById("wizardModal").style.display = "flex";
  document.getElementById("score").innerText =
    "âœ¨ Sustainability Power: " + score;
}

function closeWizard() {
  document.getElementById("wizardModal").style.display = "none";

  if (remainingItems.length === 0) {
    currentLevel++;
    if (currentLevel < levels.length) {
      loadLevel();
    } else {
      alert("ğŸ‰ You completed all levels! Sustainability Master!");
      resetGame();
    }
  } else {
    renderItems();
  }
}

/* ---------------- UTILS ---------------- */

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}
</script>

</body>
</html>

